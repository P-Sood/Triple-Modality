wandb: Starting wandb agent üïµÔ∏è
2023-10-26 11:02:53,847 - wandb.wandb_agent - INFO - Running runs: []
2023-10-26 11:02:54,364 - wandb.wandb_agent - INFO - Agent received command: run
2023-10-26 11:02:54,365 - wandb.wandb_agent - INFO - Agent starting run with config:
	T_max: 2
	batch_size: 4
	beta: 1
	clip: 1
	dropout: 0.4
	early_div: True
	epoch: 6
	epoch_switch: 3
	hidden_layers: 300
	label_task: sarcasm
	learn_PosEmbeddings: False
	learning_rate: 2.680026112438377e-05
	loss: NewCrossEntropy
	mask: False
	model: MAE_encoder
	num_layers: 6
	patience: 10
	seed: 32
	weight_decay: 0.0002429036019180394
2023-10-26 11:02:54,371 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python3 ../tav_nn.py --dataset ../../data/must
wandb: Currently logged in as: zeerak (ddi). Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
2023-10-26 11:02:59,379 - wandb.wandb_agent - INFO - Running runs: ['fvgpwkqn']
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/wandb/run-20231026_110258-fvgpwkqn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ddi/MustardTriple
wandb: üßπ View sweep at https://wandb.ai/ddi/MustardTriple/sweeps/nznlgus3
wandb: üöÄ View run at https://wandb.ai/ddi/MustardTriple/runs/fvgpwkqn
 in main 
 param_dict = {'epoch': 6, 'patience': 10, 'lr': 2.680026112438377e-05, 'clip': 1, 'batch_size': 4, 'weight_decay': 0.0002429036019180394, 'model': 'MAE_encoder', 'T_max': 2, 'seed': 32, 'label_task': 'sarcasm', 'mask': False, 'loss': 'NewCrossEntropy', 'beta': 1, 'epoch_switch': 3, 'weights': tensor([0.5000, 0.5000]), 'label2id': {'Sarcasm': 1, 'NonSarcasm': 0}, 'id2label': {1: 'Sarcasm', 0: 'NonSarcasm'}} 
 model_param = {'output_dim': 2, 'dropout': 0.4, 'early_div': True, 'num_layers': 6, 'learn_PosEmbeddings': False, 'dataset': '../../data/must'} 
 df ../../data/must , with df = 1202 
 
NewCrossEntropy
841
841
epochs:   0%|          | 0/6 [00:00<?, ?it/s]we are in multinomial dataloader
epochs:   0%|          | 0/6 [00:08<?, ?it/s]
Traceback (most recent call last):
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 305, in <module>
    main()
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 301, in main
    runModel("cuda", df_train, df_val, df_test, param_dict, model_param)
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 198, in runModel
    model = train_tav_network(
            ^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 451, in train_tav_network
    model, optimizer, criterion, scheduler, prev_val_loss, prev_f1 = one_epoch(
                                                                     ^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 376, in one_epoch
    model, optimizer, criterion, prev_val_loss, prev_f1 = not_grad_accum(
                                                          ^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 246, in not_grad_accum
    train_batch_loss = fn(
                       ^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 95, in get_statistics_big_batch
    output = checkpoint(
             ^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_compile.py", line 24, in inner
    return torch._dynamo.disable(fn, recursive)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 328, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_dynamo/external_utils.py", line 17, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 458, in checkpoint
    ret = function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/models/tav.py", line 236, in forward
    Ffusion1, _ = aud_text_layer(Ffusion1, Ffusion1, aud_outputs)
                  ^^^^^^^^^^^^^^
NameError: name 'aud_text_layer' is not defined
2023-10-26 11:03:25,599 - wandb.wandb_agent - INFO - Cleaning up finished run: fvgpwkqn
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:               epoch ‚ñÅ
wandb:       learning_rate ‚ñÅ
wandb:   log_val_iterative ‚ñÅ
wandb: log_val_multinomial ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               epoch 0
wandb:       learning_rate 3e-05
wandb:   log_val_iterative 168
wandb: log_val_multinomial 42
wandb: 
wandb: üöÄ View run silvery-sweep-2 at: https://wandb.ai/ddi/MustardTriple/runs/fvgpwkqn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231026_110258-fvgpwkqn/logs
2023-10-26 11:03:33,482 - wandb.wandb_agent - INFO - Agent received command: run
2023-10-26 11:03:33,482 - wandb.wandb_agent - INFO - Agent starting run with config:
	T_max: 3
	batch_size: 4
	beta: 1
	clip: 5
	dropout: 0.4
	early_div: True
	epoch: 6
	epoch_switch: 3
	hidden_layers: 300
	label_task: sarcasm
	learn_PosEmbeddings: False
	learning_rate: 4.899044307870224e-05
	loss: NewCrossEntropy
	mask: False
	model: MAE_encoder
	num_layers: 5
	patience: 10
	seed: 32
	weight_decay: 0.00031015366870251596
2023-10-26 11:03:33,487 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python3 ../tav_nn.py --dataset ../../data/must
wandb: Currently logged in as: zeerak (ddi). Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
2023-10-26 11:03:38,499 - wandb.wandb_agent - INFO - Running runs: ['f52du9le']
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/wandb/run-20231026_110338-f52du9le
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peach-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ddi/MustardTriple
wandb: üßπ View sweep at https://wandb.ai/ddi/MustardTriple/sweeps/nznlgus3
wandb: üöÄ View run at https://wandb.ai/ddi/MustardTriple/runs/f52du9le
 in main 
 param_dict = {'epoch': 6, 'patience': 10, 'lr': 4.899044307870224e-05, 'clip': 5, 'batch_size': 4, 'weight_decay': 0.00031015366870251596, 'model': 'MAE_encoder', 'T_max': 3, 'seed': 32, 'label_task': 'sarcasm', 'mask': False, 'loss': 'NewCrossEntropy', 'beta': 1, 'epoch_switch': 3, 'weights': tensor([0.5000, 0.5000]), 'label2id': {'Sarcasm': 1, 'NonSarcasm': 0}, 'id2label': {1: 'Sarcasm', 0: 'NonSarcasm'}} 
 model_param = {'output_dim': 2, 'dropout': 0.4, 'early_div': True, 'num_layers': 5, 'learn_PosEmbeddings': False, 'dataset': '../../data/must'} 
 df ../../data/must , with df = 1202 
 
NewCrossEntropy
841
841
epochs:   0%|          | 0/6 [00:00<?, ?it/s]we are in multinomial dataloader
epochs:   0%|          | 0/6 [00:06<?, ?it/s]
Traceback (most recent call last):
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 305, in <module>
    main()
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 301, in main
    runModel("cuda", df_train, df_val, df_test, param_dict, model_param)
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 198, in runModel
    model = train_tav_network(
            ^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 451, in train_tav_network
    model, optimizer, criterion, scheduler, prev_val_loss, prev_f1 = one_epoch(
                                                                     ^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 376, in one_epoch
    model, optimizer, criterion, prev_val_loss, prev_f1 = not_grad_accum(
                                                          ^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 246, in not_grad_accum
    train_batch_loss = fn(
                       ^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 95, in get_statistics_big_batch
    output = checkpoint(
             ^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_compile.py", line 24, in inner
    return torch._dynamo.disable(fn, recursive)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 328, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_dynamo/external_utils.py", line 17, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 458, in checkpoint
    ret = function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/models/tav.py", line 236, in forward
    Ffusion1, _ = aud_text_layer(Ffusion1, Ffusion1, aud_outputs)
                  ^^^^^^^^^^^^^^
NameError: name 'aud_text_layer' is not defined
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.027 MB of 0.027 MB uploaded (0.000 MB deduped)wandb: \ 0.027 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: | 0.031 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: / 0.036 MB of 0.036 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:               epoch ‚ñÅ
wandb:       learning_rate ‚ñÅ
wandb:   log_val_iterative ‚ñÅ
wandb: log_val_multinomial ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               epoch 0
wandb:       learning_rate 5e-05
wandb:   log_val_iterative 168
wandb: log_val_multinomial 42
wandb: 
wandb: üöÄ View run peach-sweep-3 at: https://wandb.ai/ddi/MustardTriple/runs/f52du9le
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231026_110338-f52du9le/logs
2023-10-26 11:04:15,227 - wandb.wandb_agent - INFO - Cleaning up finished run: f52du9le
2023-10-26 11:04:15,840 - wandb.wandb_agent - INFO - Agent received command: run
2023-10-26 11:04:15,841 - wandb.wandb_agent - INFO - Agent starting run with config:
	T_max: 2
	batch_size: 2
	beta: 1
	clip: 1
	dropout: 0.4
	early_div: True
	epoch: 6
	epoch_switch: 2
	hidden_layers: 300
	label_task: sarcasm
	learn_PosEmbeddings: False
	learning_rate: 8.364227841803193e-05
	loss: NewCrossEntropy
	mask: False
	model: MAE_encoder
	num_layers: 5
	patience: 10
	seed: 64
	weight_decay: 6.232903470235224e-05
2023-10-26 11:04:15,856 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python3 ../tav_nn.py --dataset ../../data/must
wandb: Currently logged in as: zeerak (ddi). Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
2023-10-26 11:04:20,868 - wandb.wandb_agent - INFO - Running runs: ['ef3y3rbk']
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/wandb/run-20231026_110420-ef3y3rbk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run exalted-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ddi/MustardTriple
wandb: üßπ View sweep at https://wandb.ai/ddi/MustardTriple/sweeps/nznlgus3
wandb: üöÄ View run at https://wandb.ai/ddi/MustardTriple/runs/ef3y3rbk
 in main 
 param_dict = {'epoch': 6, 'patience': 10, 'lr': 8.364227841803193e-05, 'clip': 1, 'batch_size': 2, 'weight_decay': 6.232903470235224e-05, 'model': 'MAE_encoder', 'T_max': 2, 'seed': 64, 'label_task': 'sarcasm', 'mask': False, 'loss': 'NewCrossEntropy', 'beta': 1, 'epoch_switch': 2, 'weights': tensor([0.5000, 0.5000]), 'label2id': {'Sarcasm': 1, 'NonSarcasm': 0}, 'id2label': {1: 'Sarcasm', 0: 'NonSarcasm'}} 
 model_param = {'output_dim': 2, 'dropout': 0.4, 'early_div': True, 'num_layers': 5, 'learn_PosEmbeddings': False, 'dataset': '../../data/must'} 
 df ../../data/must , with df = 1202 
 
NewCrossEntropy
841
841
epochs:   0%|          | 0/6 [00:00<?, ?it/s]we are in multinomial dataloader
epochs:   0%|          | 0/6 [00:07<?, ?it/s]
Traceback (most recent call last):
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 305, in <module>
    main()
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 301, in main
    runModel("cuda", df_train, df_val, df_test, param_dict, model_param)
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 198, in runModel
    model = train_tav_network(
            ^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 451, in train_tav_network
    model, optimizer, criterion, scheduler, prev_val_loss, prev_f1 = one_epoch(
                                                                     ^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 376, in one_epoch
    model, optimizer, criterion, prev_val_loss, prev_f1 = not_grad_accum(
                                                          ^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 246, in not_grad_accum
    train_batch_loss = fn(
                       ^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 41, in get_statistics
    output = model(
             ^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/models/tav.py", line 236, in forward
    Ffusion1, _ = aud_text_layer(Ffusion1, Ffusion1, aud_outputs)
                  ^^^^^^^^^^^^^^
NameError: name 'aud_text_layer' is not defined
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:               epoch ‚ñÅ
wandb:       learning_rate ‚ñÅ
wandb:   log_val_iterative ‚ñÅ
wandb: log_val_multinomial ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               epoch 0
wandb:       learning_rate 8e-05
wandb:   log_val_iterative 168
wandb: log_val_multinomial 84
wandb: 
wandb: üöÄ View run exalted-sweep-4 at: https://wandb.ai/ddi/MustardTriple/runs/ef3y3rbk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231026_110420-ef3y3rbk/logs
2023-10-26 11:04:57,555 - wandb.wandb_agent - INFO - Cleaning up finished run: ef3y3rbk
2023-10-26 11:04:58,119 - wandb.wandb_agent - INFO - Agent received command: run
2023-10-26 11:04:58,120 - wandb.wandb_agent - INFO - Agent starting run with config:
	T_max: 3
	batch_size: 2
	beta: 1
	clip: 1
	dropout: 0.4
	early_div: True
	epoch: 6
	epoch_switch: 2
	hidden_layers: 300
	label_task: sarcasm
	learn_PosEmbeddings: True
	learning_rate: 3.7358647876998405e-05
	loss: NewCrossEntropy
	mask: False
	model: MAE_encoder
	num_layers: 7
	patience: 10
	seed: 64
	weight_decay: 0.0005704592035301423
2023-10-26 11:04:58,125 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python3 ../tav_nn.py --dataset ../../data/must
2023-10-26 11:05:03,139 - wandb.wandb_agent - INFO - Running runs: ['ctx3oajk']
wandb: Currently logged in as: zeerak (ddi). Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/wandb/run-20231026_110503-ctx3oajk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run winter-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ddi/MustardTriple
wandb: üßπ View sweep at https://wandb.ai/ddi/MustardTriple/sweeps/nznlgus3
wandb: üöÄ View run at https://wandb.ai/ddi/MustardTriple/runs/ctx3oajk
 in main 
 param_dict = {'epoch': 6, 'patience': 10, 'lr': 3.7358647876998405e-05, 'clip': 1, 'batch_size': 2, 'weight_decay': 0.0005704592035301423, 'model': 'MAE_encoder', 'T_max': 3, 'seed': 64, 'label_task': 'sarcasm', 'mask': False, 'loss': 'NewCrossEntropy', 'beta': 1, 'epoch_switch': 2, 'weights': tensor([0.5000, 0.5000]), 'label2id': {'Sarcasm': 1, 'NonSarcasm': 0}, 'id2label': {1: 'Sarcasm', 0: 'NonSarcasm'}} 
 model_param = {'output_dim': 2, 'dropout': 0.4, 'early_div': True, 'num_layers': 7, 'learn_PosEmbeddings': True, 'dataset': '../../data/must'} 
 df ../../data/must , with df = 1202 
 
NewCrossEntropy
841
841
epochs:   0%|          | 0/6 [00:00<?, ?it/s]we are in multinomial dataloader
epochs:   0%|          | 0/6 [00:05<?, ?it/s]
Traceback (most recent call last):
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 305, in <module>
    main()
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 301, in main
    runModel("cuda", df_train, df_val, df_test, param_dict, model_param)
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 198, in runModel
    model = train_tav_network(
            ^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 451, in train_tav_network
    model, optimizer, criterion, scheduler, prev_val_loss, prev_f1 = one_epoch(
                                                                     ^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 376, in one_epoch
    model, optimizer, criterion, prev_val_loss, prev_f1 = not_grad_accum(
                                                          ^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 246, in not_grad_accum
    train_batch_loss = fn(
                       ^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 41, in get_statistics
    output = model(
             ^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/models/tav.py", line 236, in forward
    Ffusion1, _ = aud_text_layer(Ffusion1, Ffusion1, aud_outputs)
                  ^^^^^^^^^^^^^^
NameError: name 'aud_text_layer' is not defined
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:               epoch ‚ñÅ
wandb:       learning_rate ‚ñÅ
wandb:   log_val_iterative ‚ñÅ
wandb: log_val_multinomial ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               epoch 0
wandb:       learning_rate 4e-05
wandb:   log_val_iterative 168
wandb: log_val_multinomial 84
wandb: 
wandb: üöÄ View run winter-sweep-5 at: https://wandb.ai/ddi/MustardTriple/runs/ctx3oajk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231026_110503-ctx3oajk/logs
2023-10-26 11:05:39,885 - wandb.wandb_agent - INFO - Cleaning up finished run: ctx3oajk
2023-10-26 11:05:40,576 - wandb.wandb_agent - INFO - Agent received command: run
2023-10-26 11:05:40,576 - wandb.wandb_agent - INFO - Agent starting run with config:
	T_max: 2
	batch_size: 4
	beta: 1
	clip: 5
	dropout: 0.4
	early_div: True
	epoch: 6
	epoch_switch: 2
	hidden_layers: 300
	label_task: sarcasm
	learn_PosEmbeddings: True
	learning_rate: 7.86216317914819e-05
	loss: NewCrossEntropy
	mask: False
	model: MAE_encoder
	num_layers: 4
	patience: 10
	seed: 32
	weight_decay: 1.0307210920143704e-05
2023-10-26 11:05:40,582 - wandb.wandb_agent - INFO - About to run command: /usr/bin/env python3 ../tav_nn.py --dataset ../../data/must
wandb: Currently logged in as: zeerak (ddi). Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
2023-10-26 11:05:45,598 - wandb.wandb_agent - INFO - Running runs: ['kb60ibl0']
wandb: Tracking run with wandb version 0.15.12
wandb: Run data is saved locally in /l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/wandb/run-20231026_110545-kb60ibl0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smart-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/ddi/MustardTriple
wandb: üßπ View sweep at https://wandb.ai/ddi/MustardTriple/sweeps/nznlgus3
wandb: üöÄ View run at https://wandb.ai/ddi/MustardTriple/runs/kb60ibl0
 in main 
 param_dict = {'epoch': 6, 'patience': 10, 'lr': 7.86216317914819e-05, 'clip': 5, 'batch_size': 4, 'weight_decay': 1.0307210920143704e-05, 'model': 'MAE_encoder', 'T_max': 2, 'seed': 32, 'label_task': 'sarcasm', 'mask': False, 'loss': 'NewCrossEntropy', 'beta': 1, 'epoch_switch': 2, 'weights': tensor([0.5000, 0.5000]), 'label2id': {'Sarcasm': 1, 'NonSarcasm': 0}, 'id2label': {1: 'Sarcasm', 0: 'NonSarcasm'}} 
 model_param = {'output_dim': 2, 'dropout': 0.4, 'early_div': True, 'num_layers': 4, 'learn_PosEmbeddings': True, 'dataset': '../../data/must'} 
 df ../../data/must , with df = 1202 
 
NewCrossEntropy
841
841
epochs:   0%|          | 0/6 [00:00<?, ?it/s]we are in multinomial dataloader
epochs:   0%|          | 0/6 [00:06<?, ?it/s]
Traceback (most recent call last):
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 305, in <module>
    main()
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 301, in main
    runModel("cuda", df_train, df_val, df_test, param_dict, model_param)
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/run_slurm/../tav_nn.py", line 198, in runModel
    model = train_tav_network(
            ^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 451, in train_tav_network
    model, optimizer, criterion, scheduler, prev_val_loss, prev_f1 = one_epoch(
                                                                     ^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 376, in one_epoch
    model, optimizer, criterion, prev_val_loss, prev_f1 = not_grad_accum(
                                                          ^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 246, in not_grad_accum
    train_batch_loss = fn(
                       ^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/train_model/tav_train.py", line 95, in get_statistics_big_batch
    output = checkpoint(
             ^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_compile.py", line 24, in inner
    return torch._dynamo.disable(fn, recursive)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 328, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/_dynamo/external_utils.py", line 17, in inner
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 458, in checkpoint
    ret = function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zeerak.talat/.conda/envs/trimodal/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/zeerak.talat/Triple-Modality/TripleModels/models/tav.py", line 236, in forward
    Ffusion1, _ = aud_text_layer(Ffusion1, Ffusion1, aud_outputs)
                  ^^^^^^^^^^^^^^
NameError: name 'aud_text_layer' is not defined
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:               epoch ‚ñÅ
wandb:       learning_rate ‚ñÅ
wandb:   log_val_iterative ‚ñÅ
wandb: log_val_multinomial ‚ñÅ
wandb: 
wandb: Run summary:
wandb:               epoch 0
wandb:       learning_rate 8e-05
wandb:   log_val_iterative 168
wandb: log_val_multinomial 42
wandb: 
wandb: üöÄ View run smart-sweep-6 at: https://wandb.ai/ddi/MustardTriple/runs/kb60ibl0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231026_110545-kb60ibl0/logs
2023-10-26 11:06:17,067 - wandb.wandb_agent - ERROR - Detected 5 failed runs in a row, shutting down.
2023-10-26 11:06:17,077 - wandb.wandb_agent - INFO - To change this value set WANDB_AGENT_MAX_INITIAL_FAILURES=val
wandb: Terminating and syncing runs. Press ctrl-c to kill.
